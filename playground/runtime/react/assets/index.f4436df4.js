var L=Object.defineProperty;var m=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var f=(s,e,t)=>e in s?L(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,g=(s,e)=>{for(var t in e||(e={}))I.call(e,t)&&f(s,t,e[t]);if(m)for(var t of m(e))C.call(e,t)&&f(s,t,e[t]);return s};var r=(s,e,t)=>(f(s,typeof e!="symbol"?e+"":e,t),t);import{e as O}from"./vendor.358e0281.js";const M=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}};M();class N{constructor(e=globalThis.navigator.userAgent,t={}){r(this,"isIos",!1);r(this,"isIphone",!1);r(this,"isIpad",!1);r(this,"isAndroid",!1);r(this,"isAnroidPad",!1);r(this,"isMac",!1);r(this,"isWin",!1);r(this,"isMqq",!1);r(this,"isWechat",!1);r(this,"isWeb",!1);this.isIphone=e.indexOf("iPhone")>=0,this.isIpad=/(iPad).*OS\s([\d_]+)/.test(e),this.isIos=this.isIphone||this.isIpad,this.isAndroid=e.indexOf("Android")>=0,this.isAnroidPad=this.isAndroid&&e.indexOf("Mobile")<0,this.isMac=e.indexOf("Macintosh")>=0,this.isWin=e.indexOf("Windows")>=0,this.isMqq=/QQ\/([\d.]+)/.test(e),this.isWechat=e.indexOf("MicroMessenger")>=0&&e.indexOf("wxwork")<0,this.isWeb=!this.isIos&&!this.isAndroid&&!/(WebOS|BlackBerry)/.test(e),Object.entries(t).forEach(([o,i])=>{this[o]=i})}}const h="magic:common:events:",b="magic:common:actions:",l={SHOW:"show",HIDE:"hide",SCROLL_TO_VIEW:"scrollIntoView",SCROLL_TO_TOP:"scrollToTop"},S=[{label:"\u70B9\u51FB",value:`${h}click`}],w=(s,e)=>{const t=`${s}:${e}`;return s.startsWith(h)?t:`${h}${t}`},x=s=>s.startsWith(b),y=(s,e)=>{var o;if(!s)return!1;if(!s.id)return y(s.parentElement,e);const t=(o=e.page)==null?void 0:o.getNode(s.id);return t||!1},p=(s,e,t)=>{const o=y(t.target,s);if(o){const{instance:i,data:n}=o;s.emit(w(e,n.id),i)}},v=s=>{window.document.body.addEventListener("click",e=>{p(s,"click",e)}),window.document.body.addEventListener("click",e=>{p(s,"click:capture",e)},!0)},A=(s,e)=>{const{instance:t}=e;switch(s.replace(b,"")){case l.SHOW:t.show();break;case l.HIDE:t.hide();break;case l.SCROLL_TO_VIEW:t.$el.scrollIntoView({behavior:"smooth"});break;case l.SCROLL_TO_TOP:window.scrollTo({top:0,behavior:"smooth"});break}};class E extends O.exports.EventEmitter{constructor(e){super();r(this,"data");r(this,"style");r(this,"events");r(this,"instance");const{events:t}=e;this.data=e,this.events=t,this.listenLifeSafe(),this.once("destroy",()=>{this.instance=null,typeof this.data.destroy=="function"&&this.data.destroy(this),this.listenLifeSafe()})}listenLifeSafe(){this.once("created",e=>{this.instance=e,typeof this.data.created=="function"&&this.data.created(this)}),this.once("mounted",e=>{this.instance=e,typeof this.data.mounted=="function"&&this.data.mounted(this)})}}class $ extends E{constructor(e){super(e.config);r(this,"nodes",new Map);this.setNode(e.config.id,this),this.initNode(e.config)}initNode(e){var t;this.setNode(e.id,new E(e)),(t=e.items)==null||t.forEach(o=>{this.initNode(o)})}getNode(e){return this.nodes.get(e)}setNode(e,t){this.nodes.set(e,t)}deleteNode(e){this.nodes.delete(e)}}const P=s=>{if(typeof s!="string")return s;const e={};return s.split(";").forEach(t=>{if(!t)return;const o=t.split(":");let i=o.shift(),n=o.join(":");!i||(i=i.replace(/^\s*/,"").replace(/\s*$/,""),n=n.replace(/^\s*/,"").replace(/\s*$/,""),i=i.split("-").map((c,a)=>a>0?`${c[0].toUpperCase()}${c.substr(1)}`:c).join(""),e[i]=n)}),e},T=s=>s&&!/^url/.test(s)&&!/^linear-gradient/.test(s)?`url(${s})`:s;class j extends O.exports.EventEmitter{constructor(e){super();r(this,"env");r(this,"pages",new Map);r(this,"page");r(this,"platform","mobile");r(this,"jsEngine","browser");r(this,"components",new Map);if(this.env=new N(e.ua),e.platform&&(this.platform=e.platform),e.jsEngine&&(this.jsEngine=e.jsEngine),this.platform==="mobile"||this.platform==="editor"){const t=()=>{let{width:o}=document.documentElement.getBoundingClientRect();o=Math.min(800,o);const i=o/3.75;document.documentElement.style.fontSize=`${i}px`};t(),document.body.style.fontSize="14px",globalThis.addEventListener("resize",t)}e.transformStyle&&(this.transformStyle=e.transformStyle),e.config&&this.setConfig(e.config,e.curPage),v(this)}transformStyle(e){if(!e)return{};let t={};const o={};typeof e=="string"?t=P(e):t=g({},e);const i=["zIndex","opacity","fontWeight"];return Object.entries(t).forEach(([n,c])=>{n==="backgroundImage"?c&&(o[n]=T(c)):!i.includes(n)&&c&&/^[-]?[0-9]*[.]?[0-9]*$/.test(c)?o[n]=`${c/100}rem`:o[n]=c}),o}setConfig(e,t){var o,i,n;this.pages=new Map,(o=e.items)==null||o.forEach(c=>{this.pages.set(c.id,new $({config:c}))}),this.setPage(t||((n=(i=this.page)==null?void 0:i.data)==null?void 0:n.id))}setPage(e){let t;e&&(t=this.pages.get(e)),t||(t=this.pages.get(this.pages.keys().next().value)),this.page=t,this.platform!=="magic"&&this.bindEvents()}registerComponent(e,t){this.components.set(e,t)}unregisterComponent(e){this.components.delete(e)}resolveComponent(e){return this.components.get(e)}bindEvents(){var e;if(!!this.page){this.removeAllListeners();for(const[,t]of this.page.nodes)(e=t.events)==null||e.forEach(o=>{let{name:i}=o;S.findIndex(n=>n.value===i)>-1&&(i=w(i,`${t.data.id}`)),this.on(i,(n,...c)=>{var u;if(!this.page)throw new Error("\u5F53\u524D\u6CA1\u6709\u9875\u9762");const a=this.page.getNode(o.to);if(!a)throw`ID\u4E3A${o.to}\u7684\u7EC4\u4EF6\u4E0D\u5B58\u5728`;const{method:d}=o;if(x(d))return A(d,a);typeof((u=a.instance)==null?void 0:u[d])=="function"&&a.instance[d](n,...c)})})}}destroy(){this.removeAllListeners(),this.pages.clear()}}const W=s=>s.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),D=(s,e)=>{const t=e||location.href,o=new RegExp(`[?&#]${s}=([^&#]+)`,"gi"),i=t.match(o);let n;return i&&i.length>0?(n=i[i.length-1].split("="),n&&n.length>1?W(n[1]):""):""};export{j as A,D as g};
